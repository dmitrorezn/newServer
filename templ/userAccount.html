<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
{{/*    <link href="http://localhost:8080/style/styles.css" rel="stylesheet" type="text/css" >*/}}
{{/*    <script src="http://localhost:8080/scripts/js_scripts"></script>*/}}
{{/*    <script src="http://localhost:8080/scripts/jquery-3.2.1.min"></script>*/}}
    <title>
        Your Account
    </title>
    <meta charset = "utf-8">

    <script>
        $(document).ready(function (){
            let cookies = document.cookie
            let el
            let i
            let login = cookies.lastIndexOf("login")
            alert(login)
            let values = cookies.split(";")//[1].split("=")[1].toString()
             values.forEach(function (item,index,array){
                 el = item.split("=")
                 i = el[0]
                    if (i === 'login'){
                        alert(el[1])
                        login = login + el[1]
                    }
                })
            $("#username").append("<h>Welcome to account "+login.toString()+"</h>")
        });

        function moreInfo(ids){
            alert(ids)
            var data = {
                "idstr": ids.toString() ,
            }
            alert(data.id)
            $.ajax({
                url: "/auth/announcementinfo",
                method: "POST",
                data : JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function() {
                    $(document).ready(function() {
                        $('#content').load("/user/anninfo", function () {
                            alert("loaded");
                        });
                    });
                },
                error:function() {
                    alert("err load anninfo.html")
                },
            })
        };

        let id
        $(document).ready(function (){

                $.get( "/data/announcements", function(data) {
                    $('.anns').empty()
                    $.each(data, function(k)  {
                        id = data[k].idstr
                        $(".anns").append("<div classs='ann'>"
                            +"<h>Title:            </h>"+data[k].title+"<br>"
                            +"<h>Contact number:   </h>"+data[k].phone_number+"<br>"
                            +"<h>Activity:         </h>"+data[k].activity.name+"<br>"
                            +"<h>Q&A Email:        </h>"+data[k].email+"<br>"
                            +"<h>Start Dates:      </h>"+data[k].start_dates + "<br>"
                            +"<input type='button' value='More Info' class ='info' id='"+id+"' onclick=moreInfo('"+id+"')></div>");
                    });
                    // $('.info').on('click', function() {
                    //     alert("info cliced")
                    //     id = $(this).attr("id")
                    //     alert(id)
                    //     $('#idstr').attr("value",id.toString())
                    //     $.get( "/auth/announcementinfo/"+id.toString(), function( data ) {
                    //         alert( "Load was performed." );
                    //         $( ".result" ).html( data );
                    //         alert( "Load was performed." );
                    //     });
                    // });
                    console.log(data);
                });
        })


        function sendData() {
            let data = {
                "name": $('#name').val(),
            }
            $.ajax({
                url: '/data/show',
                type: 'POST',
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success : function(data) {
                    $('.anns').append("<div>"+ data.name +"</div>");
                },
            });
            console.log(data)
        }
        // function regAsAuthor() {
        //     let data = {
        //         "status": "author",
        //     }
        //     $.ajax({
        //         url: '/author/signin',
        //         type: 'POST',
        //         data: JSON.stringify(data),
        //         contentType: "application/javascript; charset=utf-8",
        //         dataType: "json",
        //         success: function (data) {
        //             $('#brd').append("<div>" + data.name + "</div>");
        //         },
        //     });
        // }
    </script>
</head>
<body>
<div id="username"></div><br>
{{/*<h>Your email is {{.Email}}</h><br>*/}}
<div id="content">
<div class = "anns" >
{{/*{{range .announcements}}*/}}
{{/*    <h>{{.title}}</h><br>*/}}
{{/*    <h>{{.email}}</h><br>*/}}
{{/*    <h>{{.phone_number}}</h><br>*/}}
{{/*{{end}}*/}}
</div>
    <div>

        <input type="text" id="name">
        <button onclick="sendData()">ShowData</button>
        <button class="info">Reg As author</button><br>
    </div>

</div>
</body>
</html>
